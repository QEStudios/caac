import os
os.environ["PYGAME_HIDE_SUPPORT_PROMPT"] = "1"
import winsound
import time
import random
import urllib.request
import shutil

def play_audio(url):
    filepath, _ = urllib.request.urlretrieve(url)
    winsound.PlaySound(filepath, winsound.SND_FILENAME | winsound.SND_ASYNC)

def print_text_at_time(text, seconds, colour=None):
    time.sleep(max(0, start - time.time() + seconds))
    print(text, end="", flush=True)
    if colour:
        os.system("color " + colour)

def generate_char_block():
    chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    block = "\n".join(["".join(random.choices(chars, k=terminal_width-1)) for l in range(8)])
    return "\n" + block

if __name__ == "__main__":
    audio_file_url = "https://github.com/QEStudios/caac/raw/main/caac.wav"
    terminal_width = 120
    os.system("color 0f")
    os.system("cls")
    os.system(f"mode con: cols={terminal_width} lines=30")
    c = "sseeeeeeeeeeeeeeeeeeEEEEEEEEEEEEEEEEEEEEE"
    text_timings = [
        (0.75, "ayy"),
        (1.65, """

 █████  ██    ██ ██    ██ ██    ██ 
██   ██  ██  ██   ██  ██   ██  ██  
███████   ████     ████     ████   
██   ██    ██       ██       ██    
██   ██    ██       ██       ██    """),
        (2.56, """

     e      Y88b    / Y88b    / Y88b    / Y88b    / Y88b    / Y88b    / Y88b    / Y88b    / Y88b    / Y88b    / 
    d8b      Y88b  /   Y88b  /   Y88b  /   Y88b  /   Y88b  /   Y88b  /   Y88b  /   Y88b  /   Y88b  /   Y88b  /  
   /Y88b      Y88b/     Y88b/     Y88b/     Y88b/     Y88b/     Y88b/     Y88b/     Y88b/     Y88b/     Y88b/   
  /  Y88b      Y8Y       Y8Y       Y8Y       Y8Y       Y8Y       Y8Y       Y8Y       Y8Y       Y8Y       Y8Y    
 /____Y88b      Y         Y         Y         Y         Y         Y         Y         Y         Y         Y     
/      Y88b    /         /         /         /         /         /         /         /         /         /      """),
        (3.21, "\n\nI"),
        (3.45, " got"),
        (3.68, " a"),
        (3.90, " gun"),
        (4.35, " *gun cock*"),
        (4.62, "\nno"),
        (4.78, " girls"),
        (5.41, "\ngirls"),
        (5.69, " got"),
        (5.90, "ta"),
        (6.12, " die"),
        (6.58, " *gunshots*\nha", "60"),
        (6.68, "", "0f"),
        (7.00, "\nHA", "60"),
        (7.10, "", "0f"),
        (7.46, "\nwake"),
        (7.67, " up"),
        (7.92, " with"),
        (8.15, " no"),
        (8.37, " HHHuuu"),
        (8.64, "eɘ"),
        (8.92, "uuuHHH"),
        (9.28, "\nJu"),
        (9.40, "li"),
        (9.50, "o"),
        (9.71, "-i"),
        (9.85, "o"),
        (10.00, "-i"),
        (10.07, """
 .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.   .d88b.  
.8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. .8P  Y8. 
88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 
88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 88    88 
`8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' `8b  d8' 
 `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'   `Y88P'"""),
        (10.37, "\nI"),
        (10.59, " can"),
        (10.84, " I"),
        (11.03, " can't"),
        (11.51, "\nba"),
        (11.71, "by"),
        (11.95, " jeans"),
        (12.85, "\nyou"),
        (12.97, " and"),
        (13.08, " your"),
        (13.34, " pe"),
        (13.54, "nis"),
        (13.75, " and"),
        (13.97, " poop"),
        (14.34, "nis"),
        (14.64, generate_char_block(), "f0"),
        (14.96, generate_char_block(), "0f"),
        (15.41, "\njuu"),
        (15.98, "-u"),
        (16.09, "-u"),
        (16.20, "-e"),
        (16.32, "-eeuu"),
        (16.79, "-uu"),
        (16.89, "-uuujj"),
        (17.33, "\njuj"),
        (17.76, " juj"),
        (18.23, "\nJUMP"),
        (18.67, " in"),
        (18.89, " the"),
        (19.11, " CAAC,"),
        (20.03, "\nGirl"),
        (20.25, " let's"),
        (20.46, " put"),
        (20.71, " some"),
        (20.91, " maaam"),
        (21.36, "\nmam"),
        (21.58, " mam"),
        (21.81, " maam"),
        (22.15, """
 ███▄ ▄███▓ ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      ▄▄▄      
▓██▒▀█▀ ██▒▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄   ▒████▄    
▓██    ▓██░▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄ ▒██  ▀█▄  
▒██    ▒██ ░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██░██▄▄▄▄██ 
▒██▒   ░██▒ ▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒▓█   ▓██▒
░ ▒░   ░  ░ ▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░▒▒   ▓▒█░
░  ░      ░  ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░ ▒   ▒▒ ░
░      ░     ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒    ░   ▒   
       ░         ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░     ░  ░""",
        "40"),
        (22.71, "\n\nthing", "0f"),
        (22.94, " you"),
        (23.15, " want"),
        (23.63, "\njust"),
        (23.83, " to"),
        (24.04, " put"),
        (24.25, " a"),
        (24.49, " pe"),
        (24.72, "nis"),
        (24.94, generate_char_block(), "20"),
        (25.17, generate_char_block(), "5f"),
        (25.39, "\n\nyou", "0f"),
        (25.62, " de"),
        (25.85, "serve"),
        (26.08, " it"),
        (26.28, " ba"),
        (26.52, "by"),
        (26.72, " you"),
        (26.97, " de"),
        (27.19, "serve"),
        (27.40, " it"),
        (27.73, "\nAu"),
        (27.93, "Au"),
        (28.08, "AAAAAAAA"),
        (28.98, "\nAAA"),
        (29.15, "-a"),
        (29.31, "-a"),
        (29.43, "-A"),
        (29.53, "-A"),
        (29.60, "-A"),
        (29.66, "-A"),
        (29.70, "-A"),
        (29.74, "-A"),
        (29.77, "-A"),
        (29.81, "-A"),
        (29.84, "-A"),
        (29.88, "-AAAA"),
        (30.33, "-A"),
        (30.65, "-A"),
        (30.88, """

  /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$ 
 /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$ /$$__  $$
| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$| $$  \ $$
| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$| $$$$$$$$
| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$| $$__  $$
| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$
| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$
|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/|__/  |__/""",
         "1f"),
        (31.20, "\n\ngold", "0f"),
        (31.68, " jewel"),
        (32.14, "ry"),
        (32.56, " shi"),
        (33.04, "nin'"),
        (33.46, " so"),
        (33.90, """

      :::::::::  :::::::::  ::::::::::: ::::::::  :::    ::: ::::::::::: 
     :+:    :+: :+:    :+:     :+:    :+:    :+: :+:    :+:     :+:      
    +:+    +:+ +:+    +:+     +:+    +:+        +:+    +:+     +:+       
   +#++:++#+  +#++:++#:      +#+    :#:        +#++:++#++     +#+        
  +#+    +#+ +#+    +#+     +#+    +#+   +#+# +#+    +#+     +#+         
 #+#    #+# #+#    #+#     #+#    #+#    #+# #+#    #+#     #+#          
#########  ###    ### ########### ########  ###    ###     ###           """,
         "f6"),
        (33.95, "", "7f"),
        (34.00, "", "67"),
        (34.05, "", "f6"),
        (34.10, "", "7f"),
        (34.15, "", "67"),
        (34.20, "", "0f"),
        (34.82, "\n\nstraw"),
        (35.35, "ber"),
        (35.67, "ry"),
        (36.13, " pe"),
        (36.57, "nis"),
        (37.03, " all"),
        (37.48, " nice"),
        (38.13, "\nluc"),
        (38.39, "ky"),
        (38.65, " for"),
        (38.89, " you"),
        (39.10, " that's"),
        (39.31, " what"),
        (39.49, " I"),
        (39.72, generate_char_block(), "24"),
        (39.92, "", "0f"),
        (40.42, "\nthat's"),
        (40.65, " what"),
        (40.89, " I"),
        (41.07, generate_char_block(), "c1"),
        (41.27, "", "0f"),
        (41.76, "\nluc"),
        (41.99, "ky"),
        (42.24, " for"),
        (42.46, " you"),
        (42.65, " that's"),
        (42.88, " what"),
        (43.08, " I"),
        (43.30, generate_char_block(), "95"),
        (43.50, "", "0f"),
        (43.97, "\nthat's"),
        (44.20, " what"),
        (44.44, " I"),
        (44.65, generate_char_block(), "df"),
        (44.85, "", "0f"),
        (46.00, "\n"),
    ] + [(46.00 + i*0.037, c[i], "1f" if i == 0 else None) for i in range(38)] + [
        (47.52, """
8 8888888888   8 8888888888   8 8888888888   `8.`8888.      ,8' `8.`8888.      ,8' `8.`8888.      ,8' 
8 8888         8 8888         8 8888          `8.`8888.    ,8'   `8.`8888.    ,8'   `8.`8888.    ,8'  
8 8888         8 8888         8 8888           `8.`8888.  ,8'     `8.`8888.  ,8'     `8.`8888.  ,8'   
8 8888         8 8888         8 8888            `8.`8888.,8'       `8.`8888.,8'       `8.`8888.,8'    
8 888888888888 8 888888888888 8 888888888888     `8.`88888'         `8.`88888'         `8.`88888'     
8 8888         8 8888         8 8888             .88.`8888.         .88.`8888.         .88.`8888.     
8 8888         8 8888         8 8888            .8'`8.`8888.       .8'`8.`8888.       .8'`8.`8888.    
8 8888         8 8888         8 8888           .8'  `8.`8888.     .8'  `8.`8888.     .8'  `8.`8888.   
8 8888         8 8888         8 8888          .8'    `8.`8888.   .8'    `8.`8888.   .8'    `8.`8888.  
8 888888888888 8 888888888888 8 888888888888 .8'      `8.`8888. .8'      `8.`8888. .8'      `8.`8888. """,
         "1f"),
        (47.60, "", "0f"),
        (47.78, "\nall"),
        (48.22, " night"),
    ]

    play_audio(audio_file_url)
    start = time.time()

    for timing in text_timings:
        if len(timing) == 3:
            print_text_at_time(timing[1], timing[0], timing[2])
        else:
            print_text_at_time(timing[1], timing[0])

    time.sleep(1)
